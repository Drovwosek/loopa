
### **1. Пользовательские истории (User Stories)**

Истории сформулированы в формате: **«Как [роль], я хочу [возможность], чтобы [ценность/цель]»**.

| ID    | Эпик                 | Пользовательская история                                                                                          | Критерии приемки (Acceptance Criteria)                                                                                                                                                                       |
| ----- | -------------------- | ----------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| US001 | Загрузка файла       | Как менеджер продукта, я хочу загружать аудиофайлы (MP3, WAV), чтобы система могла их обработать.                 | 1. На главной странице есть кнопка "Выбрать файл" и зона для Drag-and-Drop.  <br>2. Система принимает файлы размером до 500 МБ.  <br>3. После выбора файла отображается его имя и индикатор начала загрузки. |
| US002 | Обработка видео      | Как UX-исследователь, я хочу загружать видеофайлы (MP4, MOV), чтобы получить расшифровку только аудиодорожки.     | 1. Система автоматически извлекает аудио из видеофайла перед обработкой.  <br>2. Пользователь видит уведомление, что обрабатывается звуковая дорожка.                                                        |
| US003 | Отслеживание статуса | Как проектировщик, я хочу видеть статус обработки моего файла, чтобы понимать, когда ожидать результат.           | 1. После загрузки пользователь перенаправляется на страницу деталей задачи.  <br>2. На странице отображается понятный статус: "В обработке", "Готово", "Ошибка".                                             |
| US004 | Получение результата | Как дизайнер, я хочу видеть готовый текст в удобном для чтения виде, чтобы быстро его скопировать.                | 1. Текст отображается в чистом, прокручиваемом поле на отдельной странице.  <br>2. Есть кнопка "Скопировать весь текст" в один клик.                                                                         |
| US005 | Экспорт результата   | Как аналитик, я хочу скачать расшифровку в файл, чтобы сохранить её в общую базу знаний команды.                  | 1. Под текстом есть кнопки "Скачать TXT" и "Скачать DOCX".  <br>2. Файл сохраняется с именем `[оригинальное_имя]_транскрипт.[расширение]`.                                                                   |
| US006 | История операций     | Как пользователь, я хочу видеть список моих последних файлов, чтобы вернуться к результатам или проверить статус. | 1. На главной странице отображается список последних 10 загрузок для текущей сессии.  <br>2. Для каждого файла указано имя, дата, статус и кнопка "Удалить".                                                 |
### 2. Сущности системы (Entities)**

#### 2.1. Сущность: Файл (File)**

Хранит информацию о загруженном пользователем медиафайле.

|Атрибут (Поле)|Тип данных|Ограничения и Комментарии|
|---|---|---|
|**Уникальный идентификатор (id)**|UUID|Первичный ключ. Генерируется автоматически.|
|**Оригинальное имя файла (original_name)**|Строка (String)|Обязательное поле. Максимальная длина 255 символов.|
|**Внутренний путь к файлу (storage_path)**|Строка (String)|Уникальное значение. Путь к файлу в облачном хранилище (например, S3).|
|**Размер файла (file_size)**|Целое число (Integer)|В байтах. Не может быть отрицательным.|
|**MIME-тип файла (mime_type)**|Строка (String)|Например, `audio/mpeg`, `video/mp4`.|
|**Дата и время загрузки (uploaded_at)**|Метка времени (DateTime)|Заполняется автоматически в момент загрузки.|
|**Идентификатор сессии (user_session_id)**|Строка (String)|Связывает файл с анонимной сессией браузера пользователя.|

#### **2.2. Сущность: Задача на транскрибацию (TranscriptionTask)**

Описывает процесс и результат преобразования файла в текст.

| Атрибут (Поле)                             | Тип данных               | Ограничения и Комментарии                                                                             |
| ------------------------------------------ | ------------------------ | ----------------------------------------------------------------------------------------------------- |
| **Уникальный идентификатор (id)**          | UUID                     | Первичный ключ.                                                                                       |
| **Ссылка на файл (file_id)**               | UUID                     | Внешний ключ (Foreign Key) на сущность **Файл**. Означает, что задача принадлежит ровно одному файлу. |
| **Статус выполнения (status)**             | Перечисление (Enum)      | Допустимые значения: `ожидает`, `в процессе`, `готово`, `ошибка`. Значение по умолчанию: `ожидает`.   |
| **Использованный AI-провайдер (provider)** | Строка (String)          | Название API, например, `openai_whisper`.                                                             |
| **Определенный язык (language)**           | Строка (String)          | Код языка результата, например, `ru`, `en`. Может быть `null`, если определение не удалось.           |
| **Текст транскрипта (transcript_text)**    | Текст (Text)             | Основной результат. Может быть `null` до завершения задачи или в случае ошибки.                       |
| **Сырой ответ API (raw_response)**         | JSON                     | Необязательное поле. Для отладки и логирования ответов внешнего сервиса.                              |
| **Сообщение об ошибке (error_message)**    | Строка (String)          | Заполняется, только если статус = `ошибка`.                                                           |
| **Дата создания (created_at)**             | Метка времени (DateTime) | Заполняется автоматически при создании задачи.                                                        |
| **Дата начала обработки (started_at)**     | Метка времени (DateTime) | `null`, пока задача не перешла в статус `в процессе`.                                                 |
| **Дата завершения (completed_at)**         | Метка времени (DateTime) | `null`, пока задача не перешла в статус `готово` или `ошибка`.                                        |

#### 2.3. Сущность: Анонимная сессия (UserSession)**

| Атрибут (Поле)                                | Тип данных               | Ограничения и Комментарии                                                          |
| --------------------------------------------- | ------------------------ | ---------------------------------------------------------------------------------- |
| **Идентификатор сессии (session_id)**         | Строка (String)          | Первичный ключ. Уникальный идентификатор, хранящийся в cookies браузера.           |
| **Дата создания сессии (created_at)**         | Метка времени (DateTime) | Заполняется при первом визите пользователя.                                        |
| **Дата последней активности (last_activity)** | Метка времени (DateTime) | Обновляется при каждом действии пользователя. Нужно для очистки устаревших данных. |
### 3. Сценарии использования (Use Cases)**

#### **UC1: Загрузка аудиофайла и получение транскрипта**
**Актор:** Пользователь (менеджер продукта, дизайнер).  
**Основной поток:** Загрузка файла -> Создание задачи -> Асинхронная обработка AI-провайдером -> Отображение результата.  
**Альтернативный поток:** Ошибка валидации файла или сбоя API.

#### **UC2: Просмотр истории и удаление файла**
**Актор:** Пользователь.  
**Основной поток:** Просмотр списка последних файлов в рамках сессии -> Переход к результату.  
**Альтернативный поток:** Удаление файла и связанных данных из системы.